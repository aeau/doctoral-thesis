\subsection{Result and Analysis}

\begin{figure}[h]
    \centering
    \includegraphics[width=\linewidth]{figures/experiment-123_fixed.png}
    \caption{Rows show experiment 1-3, respectively. Each narrative graph can be seen in figure~\ref{fig:examples}.a-c, respectively. The first two columns are using interestingness-step as dimensions, and the other columns are using all dimensions in the search.}
    \label{fig:experiment123}
\end{figure}

\begin{figure}[t!]
    \centering
    \includegraphics[width=\linewidth]{figures/experiment-4_fixed.png}
    \caption{Expressive Range Analysis (ERA) and Temporal ERA (TERA) for Experiment 4. The first row is the general results for experiment 4 (ERA), while the subsequent ones are the individual results per step taken in the narrative structure design (figure~\ref{fig:examples}.d) (TERA). The first two columns are using interestingness-step as dimensions, and the other columns are using all dimensions in the search. }
    \label{fig:experiment-stepstep}
\end{figure}

%Odd columns are with level constraints and even columns without constraints.

% \begin{itemize}
%     \item Figure with expressive range analysis (just a few of dimensions) Using different graphs \checkmark
%     \item Figure with a few generated examples! and the grid! 
%     \item Figure using constraints and not, discuss the ERA based on that. \checkmark
%     \item a table! \checkmark
%     \item Comparison within studies (pair and all dims) individually. Exp 1-4 and EXP 4.x.
%     \item Comparison within Study: Constraints vs. No constraints (Pair and all dims) individually. Exp 1-4 and EXP 4.x.
%     \item Comparison between studies: Exp 1-4 and exp 4.x.
%     \item *I Would also like to do a bit of qualitative analysis based on what is generated! 
% \end{itemize}

%\input{tables/table2}

%Preliminary analysis shows that the IC MAP-Elites' coverage when generating narrative structs is similar when using level constraints or not, with a difference of 2\% in avg. across all the experiments. That shows first that level and narrative can be intertwined as constraints without losing coverage, and that they bot fit each other (Obvious since several have made this observation, although not strictly about structure). However, avg. results on x... Likewise,  

%Some thoughts to continue writing:

In tables~\ref{tab:exp-int-step} and \ref{tab:exp-all-dims}, we present the results based on our metrics for the four experiments. Table~\ref{tab:exp-int-step} uses interestingness and step as dimension for MAP-Elites, while Table~\ref{tab:exp-all-dims} uses all dimension during search. To complement the analysis, figure~\ref{fig:experiment123} shows an exemplar expressive range analysis (ERA) for experiments 1-3 in the different configurations, and figure~\ref{fig:experiment-stepstep} shows an exemplar ERA for experiment 4 and an exemplar Temporal ERA (TERA) of the design steps. An ERA is an evaluation method to explore and visualize the expressiveness of an algorithm in content space~\citepeleventh{p11smith_analyzing_2010}. TERA is an extension of ERA that allows the inspection and analysis of changes in expressiveness over a defined period, which, when used in a non-aggregated fashion, as in experiment 4, shows the delta maps of the search~\citepeleventh{p11alvarez_assessing_2021}.

Analyzing and comparing the experiments show similar and consistent results across experiments regardless of using level design constraints or not, and using all dimensions or just a pair. Experiments 1-3 present consistent and stable results, similar among them in all metrics except coverage, which is more influenced by the specific graph and what type of information it provides, such as patterns, nodes, and connections. 

Experiment 4 shows MAP-Elites adaptability throughout the different design steps, especially visible in figure~\ref{fig:experiment-stepstep}. In the first two steps (4.1 and 4.2), MAP-Elites exploration is limited due to the narrative graph's simplicity. This is expected as the default narrative graph (HERO --> CONFLICT --> ENEMY) and the fine-tuned (i.e., ENEMY changed for BAD) has an interestingness score of 0 and, when used as a target, hinders the exploration with or without level constraints. However, as the design progresses, MAP-Elites adapt. Minimal input into the graph (experiment 4.3, onwards) improves the search and interestingness following the design's trend. IC MAP-Elites maintain properties such as adaptability and stability shown before for level design generation, making it adequate for the evolution of grammars and narrative structs as well. 

%and supports the results by Alvarez et al.~\citepeleventh{p11alvarez_assessing_2021} where the search can be guided implicitly by design steps.

Experiment 4 also shows a concrete example of how the narrative graph would be used and designed by designers to change components in a game and enable different narrative structures. When put in context with the graphs for experiments 1-3, show relative diversity and expressiveness in the system. Experiment 4 and its steps show as well how the structure can relate to different "in-game" and level components, how, through the structure, designers can design main and side objectives, and how these could be approached. For instance, the DRA as a side conflict in the game and then incorporated as a main part of the game since to get the MCG, the HERO needs to face the DRA. That could then be used, in practice, to change, constrain, or adapt quests or part of the level design to be aligned with the structure.

%This is a common problem in adaptive EA; when the initial sample does not allow a diverse search. However, with minimal input into the graph (experiment 4.3, onwards), we observe a substantial increment in all metrics. Adding the PlotDevice and connecting 


%However, as the design progresses, MAP-Elites adapts; improving the search and interestingness following the design's trend. IC MAP-Elites maintains properties such as adaptability and stability shown for level design generation, making it adequate for the evolution of grammars and supports the results by Alvarez et al.~\citepeleventh{p11alvarez_assessing_2021} where the search can be guided implicitly by design steps.

%Experiment 4.1 and 4.2 (They show this in both the figure~\ref{fig:experiment-stepstep} and in both table~\ref{tab:exp-int-step} and~\ref{tab:exp-all-dims}), shows first, the effect the current designed narrative graph has on the search; resulting in low coverage and low interestingness scores. This is expected as the default narrative graph (HERO --> CONFLICT --> ENEMY) and the fine tuned (i.e., ENEMY changed for BAD) has a low interestingness score and when used as a target hinders the space to be explored with or without level constraints. This is a common problem in adaptive EA; when the initial sample does not allow a diverse search. However, with minimal input into the graph (experiment 4.3, onwards), we observe a substantial increment in all metrics. Adding the PlotDevice and connecting 

%Experiment 4.1 and 4.2 show first, the effect the current designed narrative graph has on the search; resulting in low coverage and low interestingness scores. This is expected as the default narrative graph (HERO --> CONFLICT --> ENEMY) and the fine tuned (i.e., ENEMY changed for BAD) has an interestingness score of 0 and when used as a target hinders the space to be explored with or without level constraints. This is a common problem in adaptive EA; when the initial sample does not allow a diverse search. However, with minimal input into the graph (experiment 4.3, onwards), we observe a substantial increment in all metrics. Adding the PlotDevice and connecting 



%and the properties that arise there. 
%Supporting the results by Alvarez et al. on MAP-Elites adaptability


%and fitness values (

%simplicity of the narrative graph showing low vand the other metrics suffer from that
%the the adaptability of the

%Experiment 4, is heaand its steps

Furthermore, both tables seem to show similar patterns when using level design constraints or not. Fitness and interestingness vary slightly (avg. +0.01 and -0.003, respectively), whereas coverage and unique individuals are worst (avg. 3.1\%, 366.9, respectively).\footnote{These values are a combination of both table~\ref{tab:exp-int-step}, \ref{tab:exp-all-dims}} The lower unique individuals are expected since the search space is more constrained; thus, individuals that would otherwise be feasible (i.e., fully connected graph and without inadequate self-conflicts) would become unfeasible with the level constraints. A similar analysis could be expected from the slightly higher or comparable fitness since the lesser the individuals that are generated, the lesser fitness' variance. However, this also shows a practical and possible way to intertwine and enforce inter-facet constraints, since when adding level design constraints to the narrative generation, due to the more delimited space, the search can be more guided and focused and still generate quality-diverse content~\citepeleventh{p11gravina_constrained_2016,p11liapis_constrained_2015}. 

%Fitness is slightly better (avg. 0.01) when using level constraints whereas unique individuals, interestingness, and coverage are worst (avg. 366.9, 0.003, 3.1\%, respectively)\footnote{These values are a combination of both table~\ref{tab:exp-int-step}, \ref{tab:exp-all-dims}.}. The lower unique individuals are expected since the search space is more constrained; thus, individuals that would otherwise be feasible (i.e., fully connected graph and without inadequate self-conflicts) would become unfeasible with the level constraints. A similar analysis could be expected from the slightly higher or comparable fitness since the lesser the individuals that are generated, the lesser fitness' variance. However, this also shows a practical and possible way to intertwine and enforce inter-facet constraints, since when adding level design constraints to the narrative generation, due to the more delimited space, the search can be more guided and focused and still generate quality-diverse content~\citepeleventh{p11gravina_constrained_2016,liapis_constrained_2015}. 

 
%Furthermore, both tables seem to show similar patterns when using level design constraints or not. Fitness is relatively better (avg. 0.024) when using level constraints whereas unique individuals, interestingness, and coverage are worst (avg. 559.9, 0.02, 1.8\%, respectively)\footnote{These values are a combination of both table~\ref{tab:exp-int-step}, \ref{tab:exp-all-dims}.}. The lower unique individuals are expected since the search space is more constrained; thus, individuals that would otherwise be feasible (i.e., fully connected graph and without inadequate self-conflicts) would become unfeasible with the level constraints. A similar analysis could be expected from the slightly higher or comparable fitness since the lesser the individuals that are generated, the lesser fitness' variance. However, this also shows a practical and possible way to intertwine and enforce inter-facet constraints, since when adding level design constraints to the narrative generation, due to the more delimited space, the search can be more guided and focused and still generate quality-diverse content~\citepeleventh{p11gravina_constrained_2016,liapis_constrained_2015}. 

%Furthermore, both tables seem to show similar patterns when using level design constraints or not. Fitness is relatively better (avg. 0.024) when using level constraints whereas unique individuals, interestingness, and coverage are worst (avg. 559.9, 0.02, 1.8\%, respectively)\footnote{These values are a combination of both table~\ref{tab:exp-int-step}, \ref{tab:exp-all-dims}.}. The lower unique individuals are expected since the search space is more constrained; thus, individuals that would otherwise be feasible (i.e., fully connected graph and without inadequate self-conflicts) would become unfeasible with the level constraints. A similar analysis could be expected from the slightly higher or comparable fitness as well since the lesser the individuals that are generated, the lesser variance in the fitness. However, this also shows a practical and possible way to intertwine and enforce inter-facet constraints, since when adding level design constraints to the narrative generation, due to the more delimited space, the search can be more guided and focused and still generate quality-diverse content~\citepeleventh{p11gravina_constrained_2016,liapis_constrained_2015}. 

The results point towards IC MAP-Elites, due to its constrained features and adaptability properties, being agnostic to these inter-facet constraints, which allows and ease the incorporation of these constraints in the system without having a major impact on the development. The tradeoff is then clearly that the possibility of the system to search for more or more complex narrative structures when using constraints is reduced since they would most probably violate constraints. 

%system loses the possibility to search for more complex narrative structures when using constraints since they would most probably violate constraints. 

%The results point towards IC MAP-Elites, due to its constrained features and adaptability properties, being agnostic to these inter-facet constraints, which allows and ease the incorporation of these constraints in the system without having a major impact on the development. 

%But that does not seem to hinder the capability of themodel, showing good results for the adoption and intertwined of level design and narrative. Next step would be to reincorporate those constraints into the level design part to observe how that would perform and how that would limit the level design aspect.. Finally, incorporate all together with other quest narrative systems such as questgram is another goal! 

%The level design constraints tradeoff is then clearly 

%it might be that one of the results is that IC MAP-Elites (or MAP-Elites) is agnostic to lvl constraints (probably because of the Constrained MAP-Elites), which allows and ease the incorporation of these constraints in the system, without having major repercursions in the development. 
    
%Maybe even the thing is that constraints improves the MAP-elites search. Well that is obvious, because the more constrained the search is the easier it is to "explore" the whole space, since now it is delimited.

%Yeah, we definitely lose the possibility to search more complex narrative structures when using constraints. But that does not seem to hinder the capability of themodel, showing good results for the adoption and intertwined of level design and narrative. Next step would be to reincorporate those constraints into the level design part to observe how that would perform and how that would limit the level design aspect.. Finally, incorporate all together with other quest narrative systems such as questgram is another goal! 

%, which is in line with previous research.

%individuals are high-performing.

%(I think here I should citepeleventh some sources, which basically confirm this: that more constrained space is easier and better for the search space)

%Furthermore, both tables seems to show similar patterns when using level design constraints or not. Fitness is relatively better (avg. 0.024) when using level constraints whereas unique individuals, interestingness, and coverage are worst (avg. 559.9, 0.02, 1.8\%, respectively) are substantially lower (avg. 559.9), and interestingness and coverage   (say this in some percentage\/ average!). The lower unique individuals is expected since the search space is more constrained, thus, individuals that would otherwise be feasible (i.e., fully connected graph and without inadequate self-conflicts), would become unfeasible with the level constraints. A similar analysis could be expected from the slightly higher or comparable fitness as well since the lesser the individuals that are generated, the lesser variance in the fitness. However, this also shows that when using constraints, due to the more focused search and constrain space; individuals are high-performing (I think here I should citepeleventh some sources, which basically confirm this: that more constrained space is easier and better for the search space)

%- Make emphasis that Coverage and Interestingness while better when not using level constraint, do n

When comparing the use of a pair of dimensions (interestingness and step) and all dimensions in the search regardless of having or not constraints, the difference is expected regarding coverage (avg. 11.2\% more) and unique individuals (avg. 765.3 more) generation since MAP-Elites will be able to encounter and store elites in a bigger grid. However, the quality of the individuals is subpar in comparison with a pair of dimensions regarding fitness (avg. 0.08 more) and interestingness (avg. 0.04 more). This result is in line with~\citepeleventh{p11alvarez_interactive_2020}, where their results, applied to level design, showed more coverage and individuals generated when using all dimensions but focusing on suboptimal parts of the space. Figures~\ref{fig:experiment123} and~\ref{fig:experiment-stepstep} show that the experiments explore similar spaces, sparser when using a pair of dimensions and denser when using all dimensions. When observing the heatmap intensity, the search focus is distributed across the search space when using a pair of dimensions, while when using all dimensions, the search is focused on high step levels.

%When comparing the use of a pair of dimensions (interestingness and step) and all dimensions in the search regardless of having or not constraints, the difference is expected regarding coverage (avg. 10.7\% more) and unique individuals (avg. 976.8 more) generation since MAP-Elites will be able to encounter and store elites in a bigger grid. However, the quality of the individuals is subpar in comparison with a pair of dimensions regarding fitness (avg. 0.08 more) and interestingness (avg. 0.04 more). This result is in line with~\citepeleventh{p11alvarez_interactive_2020}, where their results, applied to level design, showed more coverage and individuals generated when using all dimensions but focusing on suboptimal parts of the space. Figures~\ref{fig:experiment123} and~\ref{fig:experiment-stepstep} show that the experiments explore similar spaces, sparser when using a pair of dimensions and denser when using all dimensions. When observing the heatmap intensity, the search focus is distributed across the search space when using a pair of dimensions, while when using all dimensions, the search is focused on high step levels.

%- Experiment 4.1 and 4.2 (They show this in both the figure~\ref{fig:experiment-stepstep} and in both table~\ref{tab:exp-int-step} and~\ref{tab:exp-all-dims}), shows first, the effect the current designed narrative graph has on the search; resulting in low coverage and low interestingness scores. This is expected as the default narrative graph (HERO --> CONFLICT --> ENEMY) and the fine tuned (i.e., ENEMY changed for BAD) has a low interestingness score and when used as a target hinders the space to be explored with or without level constraints. This is a common problem in adaptive EA; when the initial sample does not allow a diverse search. However, with minimal input into the graph (experiment 4.3, onwards), we observe a substantial increment in all metrics. Adding the PlotDevice and connecting 

%Furthermore, experiment 4 shows a concrete example of how the narrative graph would be used and designed by designers to change components in a game and enable different narrative structures, which when put in context with the graphs for experiments 1-3, show relative diversity and expressiveness in the system. Experiment 4 and its steps show as well how the structure can relate to different "in-game" and level components, and how, through the structure, designers can design main and side objectives, and how these could be approached. For instance, the DRAKE as a side conflict in the game, and then incorporated as a main part of the game since to get the MCG, the HERO needs to face the DRAKE. That could then be used, in practice, to change, constraint, or adapt quests or part of the level design to be aligned with the structure.

%This would then in practice be visually different in a level

%The different narrative structures with  

%Turning towards a more qualitative analysisExperiment 4 shows how the narrative graph The diversity in the system



%\input{tables/table3}