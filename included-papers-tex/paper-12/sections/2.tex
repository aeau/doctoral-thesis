\subsection{Related Work}



% Propp~\citeptwelvth{p12propp1975-morphology} analyzed Russian folktales identifying their fundamental structure in 31 steps. His work contributed to the identification of core elements, the proposal of actions and events as \emph{functions} and narrative atoms, and roles that are recurrent within the folktales. Propp emphasized that these 31~\emph{functions} and their arrangement were the structure and what gave meaning to the story discourse. Bremond~\citeptwelvth{p12Bremond80-NarrativePossibilities} took Propp's~\emph{functions} and concepts, and developed them into~\emph{sequences} as temporal and causal structures that consider the narrative possibilities and alternative and dynamic events that result from choice, either from characters or narrators. 

% \subsubsection{Narrative Structures}

Propp~\citeptwelvth{p12propp1975-morphology} analyzed Russian folktales identifying their fundamental structure in 31 steps. His work contributed to the identification of core elements, the proposal of actions and events as \emph{functions} and narrative atoms, and roles that are recurrent within the folktales. Propp emphasized that these 31~\emph{functions} and their arrangement were the structure and what gave meaning to the story discourse. Barthes~\citeptwelvth{p12Barthes75-introStructNarr} proposed three intertwined and progressively integrated levels in narrative work: \emph{functions}, \emph{actions}, and \emph{narration}. His work is characterized by the proposal of fundamental narrative units in the~\emph{function} level to better assess and identify structures in a narrative. Furthermore, Baikadi and Cardona-Rivera~\citeptwelvth{p12Baikadi2012-Narreme} further discuss these fundamental units as~\emph{narremes} encoding narrative state and how they could be combined to narrative structures. Their work, similar to TropeTwist, proposes a graph structure of interconnected~\emph{narremes}. However, they defined narrative axes like Barthes, where each connection between~\emph{narremes} means a change along a narrative axis. In games, the narrative is usually directed by quests, which Aarseth~\citeptwelvth{p12aarseth2005hunt} discusses as a central element in games to make sense of other elements, and which are defined by Yu et al. as a form of structure, dividing the story into achievable rewards and partially ordered set of tasks~\citeptwelvth{p12yu2020quest}.



%Propp~\citeptwelvth{p12propp1975-morphology} analyzed Russian folktales identifying their fundamental structure in 31 steps. His work contributed to the identification of core elements, the proposal of actions and events as \emph{functions} and narrative atoms, and roles that are recurrent within the folktales. Propp emphasized that these 31~\emph{functions} and their arrangement were the structure and what gave meaning to the story discourse. Bremond~\citeptwelvth{p12Bremond80-NarrativePossibilities} took Propp's~\emph{functions} and concepts, and developed them into~\emph{sequences} as temporal and causal structures that consider the narrative possibilities and alternative and dynamic events that result from choice.

%Barthes~\citeptwelvth{p12Barthes75-introStructNarr} proposed three intertwined and progressively integrated levels in narrative work based on the work by Propp and Bremond, \emph{functions}, \emph{actions}, and \emph{narration}. His work is characterized by the proposal of fundamental narrative units in the~\emph{function} level to better assess and identify structures in a narrative, which then combine into hierarchical \emph{sequence} patterns. These fundamental units are:~\emph{functions}, which create the base for the narrative, and~\emph{indices} that expand~\emph{functions} with descriptions and classifiers. Baikadi and Cardona-Rivera~\citeptwelvth{p12Baikadi2012-Narreme} further discuss these fundamental units as~\emph{narremes} encoding narrative state and how they could be combined to narrative structures. Their work, similar to TropeTwist, proposes a graph structure of interconnected~\emph{narremes}. However, they defined narrative axes like Barthes, where each connection between~\emph{narremes} means a change along a narrative axis, emphasizing the temporal and causal relationships in the narrative structure.

% \subsubsection{Narrative and quest generation in Games}

%In games, the narrative is conducted by quests, which Aarseth~\citeptwelvth{p12aarseth2005hunt} discusses as a central element in games to make sense of other elements, and which are defined by Yu et al.~\citeptwelvth{p12yu2020quest} as a form of structure, dividing the story into achievable rewards and partially ordered set of tasks~\citeptwelvth{p12yu2020quest}. Aarseth~\citeptwelvth{p12Aarseth2012-Narrativetheory} discusses the similarities and distinctions between games and other types of narrative media, pointing towards games being composed predominantly of \textit{world}, \textit{objects}, \textit{characters}, and \textit{events}, which, when put together in a variable model, can be used to describe games on these dimensions and find relations and describe them.

%Furthermore, the generation of narratives, stories, and quests using a variety of techniques such as planning algorithms~\citeptwelvth{p12Riedl2006-StoryPlanningCreativity,young2013-plansNarrGen,Horswill2020-Generativetext}, grammars~\citeptwelvth{p12hartsook2011-storyWorlds,Alvarez2021-questgram}, or machine learning~\citeptwelvth{p12tambwekar2019-controllableNeuralStory,vanstegeren2021-gpt2quests}, is a growing and important field within games research and narrative research in general~\citeptwelvth{p12Gervas2009-ComputationalStoryCreativity,kybartas2016survey,yu2020quest,Eladhari2014-storymakinggames}. One typical approach for the generation of content and stories is the use of patterns representing different elements such as level design patterns~\citeptwelvth{p12Alvarez2020-ICMAPE,flodtol2020-WIPMakeSenseDungs}, quest patterns and common quests in games~\citeptwelvth{p12Trenton2010-questpatterns,Doran2011-questsMMORPGs}, or identifying fundamental units and assembling them based on various pre-conditions~\citeptwelvth{p12Kreminski2018-SketchingStorylets,Garbe2019-StoryletsAssembler}. A particular type of pattern is tropes, which are concepts that are recurrently used in transmedia storytelling~\citeptwelvth{p12tropesSimpsons,tvtropes}. Horswill~\citeptwelvth{p12Horswill2016-DearLeaderTrope} focused on constructing an expressive language that could encode plot tropes as story fragments, composing a database of fragments combined sequentially with a planner. Similarly, Thompson et al.~\citeptwelvth{p12Thompson2018-usingTropesNarrativeEvents} used the idea of tropes as story bits where a system would construct valid stories from users' defined story bits with pre-and post-conditions.

Furthermore, the generation of narratives, stories, and quests using a variety of techniques such as planning algorithms~\citeptwelvth{p12Riedl2006-StoryPlanningCreativity,p12young2013-plansNarrGen}, grammars~\citeptwelvth{p12hartsook2011-storyWorlds,p12Alvarez2021-questgram}, or machine learning~\citeptwelvth{p12tambwekar2019-controllableNeuralStory,p12vanstegeren2021-gpt2quests}, is a growing and important field within games research and narrative research in general~\citeptwelvth{p12Gervas2009-ComputationalStoryCreativity,p12kybartas2016survey,p12yu2020quest,p12Eladhari2014-storymakinggames}. One typical approach for the generation of content and stories is the use of patterns representing different elements such as level design patterns~\citeptwelvth{p12alvarez2019empowering,p12flodtol2020-WIPMakeSenseDungs}, quest patterns and common quests in games~\citeptwelvth{p12Trenton2010-questpatterns,p12Doran2011-questsMMORPGs}, or identifying fundamental units and assembling them based on various pre-conditions~\citeptwelvth{p12Kreminski2018-SketchingStorylets,p12Garbe2019-StoryletsAssembler}. A particular type of pattern is tropes, which are concepts that are recurrently used in transmedia storytelling~\citeptwelvth{p12tropesSimpsons,p12tvtropes}. Horswill~\citeptwelvth{p12Horswill2016-DearLeaderTrope} focused on constructing an expressive language that could encode plot tropes as story fragments, composing a database of fragments combined sequentially with a planner. Similarly, Thompson et al.~\citeptwelvth{p12Thompson2018-usingTropesNarrativeEvents} used the idea of tropes as story bits where a system would construct valid stories from users' defined story bits with pre-and post-conditions. TropeTwist uses the idea of tropes for nodes and patterns in structures and encodes and represents these as a graph. \emph{Scheherazade} is a system that can capture narrative structures by encoding and annotating narrative texts, which introduced the Story Intention Graph model, a formal and expressive representation of narratives~\citeptwelvth{p12elson-2012-dramabank}.

%instrel and Scheherazade are two earlier story graph systems. The former, 

%and which introduced the Story Intention Graph model, a formal and expressive representation of narratives~\citeptwelvth{p12elson-2012-dramabank}.

%that is able to capture narrative structures by encoding and annoting narrative texts

%whi story graph system, where 



%Taking this system and discussion a step forward, TropeTwist could be put in-place in a holistic system, where the generic nature of the structures could be useful for other systems such as quest or level design tools~\citeptwelvth{p12Liapis2019-OrchestratingGames}. For instance, the work by Dormans and Bakkes~\citeptwelvth{p12dormans2011generating} generate missions and space using a ``key and lock'' structural idea, which is similar to how we encode TropeTwist. However, their work creates levels after missions rather than orchestrating the facets and intertwining them.

%Ludoscope? 

%Moreover, to encode and generate narrative structures, we use graph grammars and grammar recipes. This approach is similar to how Dormans and Bakkes \citeptwelvth{p12dormans2011generating} generate missions and space using a ``key and lock'' structural idea, which was later employed by Juliani et al.~\citeptwelvth{p12Juliani2019-obstacleTower} to create levels targeted to reinforcement learning agents.

% where users could define their own set with pre-and post-conditions, and through Answer Set Programming, the system constructed valid stories. 



% MAP-Elites has been used... 

% % \textbf{Add the following papers}: The paper from Gozalez-duque et al. where they used intelligent trial and error algorithm to find levels suitable to agents~\citeptwelvth{p12Gonzalez-Duque2020-DifficultyTrialError}. The paper from Schrum et al., where they use interactive evolution to evolve GANs (perhaps fits better as an approach to interactive evolution)~\citeptwelvth{p12Schrum2020-IE_GAN}. The work by Cully and Demiris where they present a framework for QD, but specifically because of the curiosity score they introduced to select cells~\citeptwelvth{p12Cully2018-QDFramework}. The work by Cully where he takes the work by Fontaine et al.~\citeptwelvth{p12fontaine2019covariance} that introduces emitters, and create a set of multi-emitters to generate individuals (or evaluate individuals differently) that outperfom all other map-elites.~\citeptwelvth{p12cully2020-multiemitter}. The work by Justesen et al., where they extended MAP-Elites with \emph{Adaptive Sampling} and \emph{Drifting-Elites}, discussing about domains where fitness functions and behavior evaluations are stochastic i.e., noisy domains~\citeptwelvth{p12Justesen2019-MAPElitesNoisyDomains}. The work by Steckel and Schrum where they use different amounts of data to train GANs and used MAP-Elites to explore the diversity of generated levels (this paper is quite new, I guess that they are submitting to GECCO)~\citeptwelvth{p12steckel2021-MAPElitesGANLodeRunner}. Finally, the work by Gaier et al. where they use Variational Autoencoders to model the highest performing individuals in MAP-Elites and is able to create multiple encodings of the solutions, reducing the dimensionality and direct encoding, as well as reaching high-performance faster~\citeptwelvth{p12Gaier2020-AutomatingRDMAP-Elites}.
% MAP-Elites, a quality-diversity (QD) algorithm, seeks to \emph{illuminate} a \emph{behavior space}
% %Unlike traditional optimization algorithms that aim at finding a single best solution, QD algorithms try 
% by trying to find the best solutions across a feature-dimension grid~\citeptwelvth{p12Mouret2015}.
% % many diverse solutions. The standard version of MAP-Elites creates a grid of $n$ dimensions, where $n$ is the number of different behavioral characteristics (BC). It then tries to find the best solution in each grid cell~\citeptwelvth{p12Mouret2015}.
% Some versions skip the grid in favour of voronoi tesselation to decide which elite individuals to keep in the map~\citeptwelvth{p12cvt-mape2016}. Other works combine the effective adaptive search of Covariance Matrix Adaptation Evolution Strategies with a map of elites, yielding large improvements for real-valued representations in terms of both objective value and number of elites discovered~\citeptwelvth{p12fontaine2019covariance}. 
% %This work was extended by Cully, introducing Multi-Emitter MAP-Elites (ME-MAP-Elites)~\citeptwelvth{p12cully2020-multiemitter}.
% ME-MAP-Elites~\citeptwelvth{p12cully2020-multiemitter} creates a set of emitters to focus on different optimization processes that are active at different generations, generating higher performing and diverse individuals.% than tested baselines.
% %has addressed the core optimization process of MAP-Elites, which in its original form consists of rank selection and non-adaptive mutation and crossover. In particular, the CMA-ME algorithm 
% %MAP-Elites do away with the grid structure, such as CVT-MAP-Elites, which instead uses 

% Constrained MAP-Elites~\citeptwelvth{p12Khalifa2018}
% %was introduced by Khalifa et al.~\citeptwelvth{p12Khalifa2018} in the context of generating bosses for bullet hell games. The key innovation here is to 
% combines divergent search with a two-population approach to constraint satisfaction, taken from the FI-2Pop algorithm~\citeptwelvth{p12Kimbrough2008}. Constrained MAP-Elites has been used as the basis for subsequent experiments, e.g., to find sets of levels implementing diverse game mechanics~\citeptwelvth{p12charity2020mech}. This algorithm was later combined with interactive evolution to yield the aforementioned Interactive Constrained MAP-Elites~\citeptwelvth{p12Alvarez2020-ICMAPE}. %\citeptwelvth{p12alvarez2019empowering} 
% Moreover, MAP-Elites has been shown to be robust at adapting to changing conditions after running the algorithm thanks to its generated behavioral repertoire. This was proposed and tested in the intelligent trial-and-error algorithm~\citeptwelvth{p12Cully2015-qdRobotsAnimals,Gonzalez-Duque2020-DifficultyTrialError}. 
% %In games, this algorithm was used by Gonzalez-Duque et al. to evolve a repertoire of levels suited to different agents and finding levels difficult enough for a different set of agents in a few trials~\citeptwelvth{p12Gonzalez-Duque2020-DifficultyTrialError}.
% Related work extended MAP-Elites with \emph{Adaptive Sampling} and \emph{Drifting-Elites} to be more robust in noisy environments and domains where the fitness and behavior evaluation might be stochastic such as games~\citeptwelvth{p12Justesen2019-MAPElitesNoisyDomains}.

% \subsubsection{Narrative Evaluation}

Moreover, we use graph grammars and grammar recipes to generate structures. This approach is similar to how Dormans and Bakkes \citeptwelvth{p12dormans2011generating} generate missions and space using a ``key and lock'' structural idea. Our approach uses MAP-Elites, a quality-diversity algorithm that uses behavioral dimensions that are orthogonal to the objective function to store diverse individuals in a grid~\citeptwelvth{p12Mouret2015-MAPElites}. Evolutionary algorithms are a popular approach in PCG to generate diverse type of content~\citeptwelvth{p12Togelius2011}, but not as much for narrative content. MAP-Elites have been used to generate content in different game facets such as levels~\citeptwelvth{p12charity2020baba,p12Alvarez2020-ICMAPE}, mechanics~\citeptwelvth{p12charity2020mech}, or enemy behavior~\citeptwelvth{p12Khalifa2018}.

%, which was later employed by Juliani et al.~\citeptwelvth{p12Juliani2019-obstacleTower} to create levels targeted to reinforcement learning agents. 

% The latter, introduced Constrained MAP-Elites combining MAP-Elites with a FI-2Pop algorithm to find \textbf{think on another facet!}. Evolutionary algorithms are a popular  Search based-approaches within procedural content generation mainly

Assessing narratives is a complex and non-trivial task. The goal is to create a narrative that is both syntactically correct (e.g., coherent and consistent) and semantically rich (e.g., novel and interesting)~\citeptwelvth{p12Rowe2009-STORYEVAL,p12Hargood2011-NarrativeCohesion,p12Castricato2021-FabulaStoryCoherenceMeasure}. Perez y Perez and Ortiz~\citeptwelvth{p12Perez2013-AutomaticModelInterestingness} proposed a model to evaluate interestingness based on novelty and correct story recount, with emphasis on the story's opening, closure, and dramatic tensions. Szilas et al.~\citeptwelvth{p12Szilas2016-QualQuantInterestingness} discuss interestingness as a paradox dramatic situation with obstacles and conflicts, albeit applicable to stories as successive events. Yet, to approach subjective measurements such as interestingness, most research turns towards having human evaluation~\citeptwelvth{p12Kreminski2019-StorySifter,p12Lankoski2013-StoryConsistencyInteresting} or using such to form human models to be used as surrogate models~\citeptwelvth{p12Sharna2007-PreferenceModelingStories,p12Li2010-plannerPlotAdapt}.
%, which is the future work for TropeTwist, implementing it in a mixed-initiative system~\citeptwelvth{p12yannakakis2014micc}. 

% MAP-Elites has been used...

% In TropeTwist, we use trope patterns to evaluate interestingness and coherence.

%\input{tables/table2}
\input{included-papers-tex/paper-12/tables/table2_changed}